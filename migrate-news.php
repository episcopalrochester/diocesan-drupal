<?php


$sources = array(
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3165494',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3161520',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3161277',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3159652',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3158962',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3158289',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3158292',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3158293',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3158113',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3157816',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3157818',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3157524',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3157525',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3157526',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3157527',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3157256',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3156989',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3156954',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3156957',
		'http://www.episcopalrochester.org/dfc/newsdetail_2/3156961',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156963',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156844',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156765',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156532',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156498',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156461',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156338',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156342',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3156247',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3155510',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3155314',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3153760',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3153497',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3151773',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3151007',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3151236',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3151149',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3151030',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3150334',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3150221',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3150094',
'http://www.episcopalrochester.org/dfc/newsdetail_2/3150095',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350358',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350354',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350351',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350350',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350349',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350346',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350347',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350343',


'http://www.episcopalrochester.org/dfc/newsdetail_2/1350339',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350340',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350334',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350332',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350330',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350331',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350329',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350309',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350303',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350298',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350299',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350295',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350290',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350291',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350287',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350283',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350279',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350280',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350281',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350282',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350277',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350275',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350271',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350266',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350265',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350263',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350264',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350260',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350259',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350256',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350255',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350254',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350253',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350250',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350249',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350244',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350240',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350241',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350237',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350233',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350232',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350223',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350224',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350222',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350217',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350218',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350216',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350213',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350212',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350209',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350208',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350207',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350203',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350205',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350200',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350185',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350190',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350191',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350192',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350189',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350188',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350187',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350186',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350182',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350177',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350178',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350179',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350174',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350173',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350172',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350168',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350171',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350166',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350161',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350165',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350164',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350163',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350162',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350159',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350155',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350156',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350154',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350152',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350150',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350136',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350132',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350133',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350131',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350130',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350148',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350149',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350129',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350118',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350113',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350117',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350109',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350110',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350112',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350106',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350102',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350100',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350097',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350099',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350092',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350089',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350087',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350085',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350080',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350077',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350073',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350067',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350036',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350029',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350029',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350011',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350012',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350013',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350005',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350006',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350007',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350008',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350009',
'http://www.episcopalrochester.org/dfc/newsdetail_2/1350010',


);

function find_class($dom,$class) {
	$finder = new DomXPath($dom);
	$nodes = $finder->query("//*[contains(concat(' ', normalize-space(@class), ' '), ' $class ')]");
	$tmp_dom = new DOMDocument();
	foreach ($nodes as $node)
	{
		$tmp_dom->appendChild($tmp_dom->importNode($node,true));
		$found = trim($tmp_dom->saveHTML());
	}
	return $found;
}

print '"title","date","subhead","byline","body","guid"'."\n";

foreach ($sources as $source) {
	$html = file_get_contents($source);
	$dom = new DOMDocument();
	$dom->loadHTML($html); 

	print '"'.str_replace('"',"'",html_entity_decode(trim(strip_tags(find_class($dom,"news-title"))))).'"';
	print ",";
	print '"'.trim(strip_tags(find_class($dom,"news-date"))).'"';
	print ",";
	print '"'.trim(strip_tags(find_class($dom,"subheading"))).'"';
	print ",";
	print '"'.str_replace("By ","",trim(strip_tags(find_class($dom,"by")))).'"';
	print ",";
	print '"'.str_replace('\"',"'",addslashes(trim(str_replace("\r","",str_replace("\n","",find_class($dom,"newsclip")))))).'"';
	print ",";
	$url = explode("/",$source);
	print '"'.array_pop($url).'"';
	print "\n";
}
exit;
